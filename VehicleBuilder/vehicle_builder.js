(()=>{"use strict";var e=0;function t(e,t){const a=document.createElement("TH");return a.innerHTML=t,e.appendChild(a),a}function a(t,a,r,s=!0){const n=document.createElement("SPAN"),o=document.createElement("LABEL");a.id="internal_id_"+(++e).toString(),o.htmlFor=a.id,o.style.marginLeft="0.25em",o.style.marginRight="0.5em",o.textContent=t,a.setAttribute("type","checkbox"),n.appendChild(o),n.appendChild(a),r.appendChild(n),s&&r.appendChild(document.createElement("BR"))}class r{static IsNullOrWhiteSpace(e){try{return null==e||"undefined"==e||e.toString().replace(/\s/g,"").length<1}catch(e){return console.log(e),!1}}static Join(e,...t){try{const a=t[0];if(Array.isArray(a)||a instanceof Array){let t=r.Empty;for(let r=0;r<a.length;r++){const s=a[r];r<a.length-1?t+=s+e:t+=s}return t}if("object"==typeof a){let t=r.Empty;const s=a;return Object.keys(a).forEach((a=>{t+=s[a]+e})),t=t.slice(0,t.length-e.length),t}const s=t;return r.join(e,...s)}catch(e){return console.log(e),r.Empty}}static Format(e,...t){try{return e.match(r.regexNumber)?r.format(r.regexNumber,e,t):e.match(r.regexObject)?r.format(r.regexObject,e,t,!0):e}catch(e){return console.log(e),r.Empty}}static format(e,t,a,s=!1){return t.replace(e,(function(e,t){const n=e.split(":");let o;return n.length>1&&(t=n[0].replace("{",""),e=n[1].replace("}","")),o=s?a[0][t]:a[t],null==o||null==o||e.match(/{\d+}/)?o:(o=r.parsePattern(e,o),void 0!==o&&null!=o?o:r.Empty)}))}static parsePattern(e,t){switch(e){case"L":return t.toLocaleLowerCase();case"U":return t.toLocaleUpperCase();case"d":if("string"==typeof t)return r.getDisplayDateFromString(t);if(t instanceof Date)return r.Format("{0:00}.{1:00}.{2:0000}",t.getDate(),t.getMonth(),t.getFullYear());break;case"s":if("string"==typeof t)return r.getSortableDateFromString(t);if(t instanceof Date)return r.Format("{0:0000}-{1:00}-{2:00}",t.getFullYear(),t.getMonth(),t.getDate());break;case"n":{"string"!=typeof t&&(t=t.toString());const e=t.replace(/,/g,".");if(isNaN(parseFloat(e))||e.length<=3)break;const a=e.split(/[^0-9]+/g);let s=a;a.length>1&&(s=[r.join("",...a.splice(0,a.length-1)),a[a.length-1]]);const n=s[0],o=n.length%3;let i=o>0?n.substring(0,o):r.Empty;const l=n.substring(o).match(/.{3}/g);return i=i+"."+r.Join(".",l),i+(s.length>1?","+s[1]:"")}case"x":return this.decimalToHexString(t);case"X":return this.decimalToHexString(t,!0)}return"number"!=typeof t&&isNaN(t)||isNaN(+e)||r.IsNullOrWhiteSpace(t)?t:r.formatNumber(t,e)}static decimalToHexString(e,t=!1){const a=parseFloat(e).toString(16);return t?a.toLocaleUpperCase():a}static getDisplayDateFromString(e){const t=e.split("-");if(t.length<=1)return e;let a=t[t.length-1];const r=t[t.length-2],s=t[t.length-3];return a=a.split("T")[0],a=a.split(" ")[0],`${a}.${r}.${s}`}static getSortableDateFromString(e){const t=e.replace(",","").split(".");if(t.length<=1)return e;const a=t[t.length-1].split(" ");let s=r.Empty;a.length>1&&(s=a[a.length-1]);let n=`${t[t.length-1].split(" ")[0]}-${t[t.length-2]}-${t[t.length-3]}`;return!r.IsNullOrWhiteSpace(s)&&s.length>1?n+=`T${s}`:n+="T00:00:00",n}static formatNumber(e,t){const a=t.length,r=e.toString();if(a<=r.length)return r;let s=a-r.length;return s+=1,new Array(s).join("0")+r}static join(e,...t){let a=r.Empty;for(let s=0;s<t.length;s++)if(!("string"==typeof t[s]&&r.IsNullOrWhiteSpace(t[s])||"number"!=typeof t[s]&&"string"!=typeof t[s])){a+=""+t[s];for(let n=s+1;n<t.length;n++)if(!r.IsNullOrWhiteSpace(t[n])){a+=e,s=n-1;break}}return a}}function s(){n(),d().hash&&(x.forEach(o),b?.observe(document,v),h(),w=setTimeout(n,S))}function n(){clearTimeout(w),cancelAnimationFrame(y),b?.disconnect(),x.forEach(i)}function o(e){document.addEventListener(e,n)}function i(e){document.removeEventListener(e,n)}function l(e){if(e.defaultPrevented)return;const t=function(e){let t=e;for(;t&&"A"!==t.nodeName;)t=t.parentElement;return t}(e.target);t&&t.hash&&t.pathname===d().pathname&&m(s)}function c(){m(h)}function h(){const e=d().hash;if(!e)return;const t=decodeURIComponent(e.substring(1)),a=g.call(null,t);a&&_.call(null,a)}function d(){return location}function p(e){return document.getElementById(e)}function u(e){e.scrollIntoView()}function m(e){cancelAnimationFrame(y),y=requestAnimationFrame(e)}let g,_,f,b,w,y;r.regexNumber=/{(\d+(:\w*)?)}/g,r.regexObject=/{(\w+(:\w*)?)}/g,r.Empty="";const v={attributes:!0,characterData:!0,childList:!0,subtree:!0},S=1e4,x=["selectstart","touchend","wheel"];var C;!function(e){e.None="None",e.Tiny="Tiny",e.Small="Small",e.Medium="Medium",e.Large="Large",e.Huge="Huge"}(C||(C={}));class k{constructor(e){this.cost=0,this.upkeep=0,this.speed=0,this.torque=0,this.handling=0,this.integrity=0,this.safety=0,this.reliability=0,this.fuel=0,this.stress=0,this.volume=0,e&&(e.cost&&(this.cost=e.cost),e.upkeep&&(this.upkeep=e.upkeep),e.speed&&(this.speed=e.speed),e.torque&&(this.torque=e.torque),e.handling&&(this.handling=e.handling),e.integrity&&(this.integrity=e.integrity),e.safety&&(this.safety=e.safety),e.reliability&&(this.reliability=e.reliability),e.fuel&&(this.fuel=e.fuel),e.stress&&(this.stress=e.stress),e.volume&&(this.volume=e.volume))}add(e){this.cost+=e.cost,this.upkeep+=e.upkeep,this.speed+=e.speed,this.torque+=e.torque,this.handling+=e.handling,this.integrity+=e.integrity,this.safety+=e.safety,this.reliability+=e.reliability,this.fuel+=e.fuel,this.stress+=e.stress,this.volume+=e.volume}}var E=[{HP:10,name:"Motorcycle",speed:3,fuel:15,upkeep:0,reliability:2,cost:-1,special:["Gains 3 Fuel Uses instead of 1 when refuelling from jerry cans and other sources."]},{HP:20,name:"Sedan",speed:4,fuel:13,upkeep:0,reliability:2,cost:0,special:["Gains 3 Fuel Uses instead of 1 when refuelling from jerry cans and other sources."]},{HP:40,name:"Sports Car",speed:5,fuel:12,upkeep:0,reliability:1,cost:1,special:["Gains 3 Fuel Uses instead of 1 when refuelling from jerry cans and other sources."]},{HP:60,name:"Truck",speed:6,fuel:11,upkeep:0,reliability:1,cost:2,special:["Gains 3 Fuel Uses instead of 1 when refuelling from jerry cans and other sources."]},{HP:80,name:"Tankette",speed:7,fuel:10,upkeep:1,reliability:0,cost:3,special:[]},{HP:100,name:"Cable Train",speed:8,fuel:9,upkeep:1,reliability:0,cost:4,special:[]},{HP:120,name:"Light Tank",speed:9,fuel:8,upkeep:1,reliability:-1,cost:5,special:[]},{HP:150,name:"Medium Tank",speed:10,fuel:6,upkeep:2,reliability:-1,cost:6,special:[]},{HP:180,name:"Aircraft",speed:11,fuel:4,upkeep:2,reliability:-2,cost:8,special:[]}],A=[],P=[];for(let e of E){let t=structuredClone(e);t.fuel*=2,A.push(t);let a=structuredClone(e);a.fuel=Math.floor(a.fuel/2),P.push(a)}const L=[{name:"Human Powered",stress:1,powerplants:[{HP:0,name:"Humans",speed:1,cost:-2,special:["Requires 1 human per volume.",'"Engine" takes Injury where they would normally take Wear.',"Reliability modifier is equal to the Higest Attribute."]}],special:[]},{name:"Wind Powered",powerplants:[{HP:0,name:"Sails",special:["Does not need to Crank Start","Cannot Gun the Engine","Does not catch fire at 7 Wear","Max Speed is Wind strength, half that into the wind. This speed is unmodified by Volume.","Requires 1 bold sailor per Volume to man the rigging.","Cannot be armoured."]}],special:[]},{name:"Petrol",powerplants:E,special:[]},{name:"Supercharged Petrol",cost:3,powerplants:E,special:["Ignore high altitude penalties."]},{name:"Diesel",cost:2,speed:-1,torque:1,reliability:1,powerplants:A,special:[]},{name:"Steam",cost:-2,speed:-2,torque:2,stress:1,reliability:2,volume:1,integrity:-5,powerplants:E,special:["At 7 Wear, pushes Burn Out as the boiler explodes!"]},{name:"Electric",cost:3,speed:1,torque:-1,handling:5,powerplants:P,special:["Auto-pass Crank Start.","Cannot Gun the Engine.","Must recharge in town or with a generator."]},{name:"Clockwork",cost:2,integrity:5,powerplants:P,special:["Auto-pass Crank Start.","Does not burn at 7 Wear.",'On Check Engine, cannot choose to take Wear or shut down; this is replaced with "Spend 1 Fuel Use".',"Must recharge in town or with a generator."]}],N=["Monowheel","Two-Wheeled","Three-Wheeled","Four-Wheeled","Six-Wheeled","Half-Track","Continuous Track","Crawler","Half-Walker","Walker","Skids","Skiis","Boat Hull","Amphibious","Cable Car","Sky-Line","Dorandisch Earthline"],T=[{size:C.None,handling:0,speedmod:0,maxHP:0,integrity:0},{size:C.Small,handling:45,speedmod:1,maxHP:20,integrity:6},{size:C.Medium,handling:40,speedmod:1,maxHP:40,integrity:8},{size:C.Medium,handling:35,speedmod:0,maxHP:60,integrity:10},{size:C.Medium,handling:30,speedmod:0,maxHP:80,integrity:12},{size:C.Large,handling:25,speedmod:-1,maxHP:100,integrity:14},{size:C.Large,handling:20,speedmod:-1,maxHP:120,integrity:16},{size:C.Huge,handling:15,speedmod:-1,maxHP:150,integrity:18},{size:C.Huge,handling:10,speedmod:-2,maxHP:180,integrity:20}];class I{constructor(e){this.name=e.name,this.abbr=e.abbr,this.cost=e.cost,this.loader=e.loader??!1,this.braced=e.braced??!1,this.heavy=e.heavy??0,this.artillery=e.artillery??!1,this.artillery&&(this.loader=!0,this.braced=!0),this.indirect=e.indirect??!1}}var H=[new I({name:"None",abbr:void 0,cost:void 0,loader:!1}),new I({name:"Heavy Submachine Gun",abbr:"HSG",cost:2,braced:!0,loader:!0}),new I({name:"Landflammenwerfer",abbr:"LFW",cost:3}),new I({name:"Static Gun",abbr:"Static Gun",cost:4}),new I({name:"Light Machine Gun",abbr:"LMG",cost:2,loader:!0,braced:!0}),new I({name:"Water-Cooled Machine Gun",abbr:"WMG",cost:3,loader:!0,braced:!0,heavy:2}),new I({name:"Automatic Rifle",abbr:"AR",cost:3,loader:!0,braced:!0}),new I({name:"Hailstorm Shotgun",abbr:"HSS",cost:4,loader:!0,braced:!0,heavy:3}),new I({name:"Rotary Machine Gun",abbr:"RMG",cost:5,loader:!0,braced:!0,heavy:2}),new I({name:"PuF Machine Gun",abbr:"PMG",cost:5,loader:!0,braced:!0,heavy:3}),new I({name:"Anti-Tank Rifle",abbr:"ATR",cost:4,loader:!1,braced:!0}),new I({name:"Coilgun Rifle",abbr:"Coilgun Rifle",cost:10,loader:!1,braced:!0}),new I({name:"Trench Mortar",abbr:"TM",cost:1,loader:!0,braced:!0,indirect:!0}),new I({name:"Repeater Cannon",abbr:"RPC",cost:6,loader:!0,braced:!0,heavy:3}),new I({name:"Infantry Support Cannon",abbr:"ISC",cost:6,heavy:2,artillery:!0}),new I({name:"Recoilless Cannon",abbr:"RRC",cost:5,loader:!0,braced:!0,heavy:2}),new I({name:"Pom-Pom Gun",abbr:"POM",cost:10,artillery:!0,heavy:3}),new I({name:"Flak Cannon",abbr:"FLAK",cost:5,artillery:!0,heavy:3}),new I({name:"Field Cannon",abbr:"FC",cost:8,artillery:!0,heavy:3}),new I({name:"Heavy Field Cannon",abbr:"HFC",cost:15,artillery:!0,heavy:5}),new I({name:"Rocket Artillery Rail",abbr:"RAR",cost:2,artillery:!0,heavy:.5}),new I({name:"Assault Howitzer",abbr:"AH",cost:8,artillery:!0,heavy:4}),new I({name:"Company Mortar",abbr:"Company Mortar",cost:3,artillery:!0,heavy:3}),new I({name:"Light Howitzer",abbr:"Light Howitzer",cost:8,artillery:!0,heavy:4}),new I({name:"Medium Howitzer",abbr:"Medium Howitzer",cost:12,artillery:!0,heavy:5}),new I({name:"Siege Cannon",abbr:"Siege Cannon",cost:16,artillery:!0,heavy:6}),new I({name:"Other Weapon",abbr:"Other",cost:void 0})];const M=[{name:"None"},{name:"Driver"},{name:"Commander"},{name:"Gunner"},{name:"Gun Crew"},{name:"Mechanic"},{name:"Passenger"},{name:"Passenger (Cramped)"},{name:"Stretcher"}];class G{constructor(e,t,a,r,s,n,o){this.enclosed=e,this.coupla=t,this.sealed=a,this.loop_front=r,this.loop_left=s,this.loop_right=n,this.loop_back=o}}class F{constructor(e,t,a,r,s,n,o,i,l,c){this.name_txt=e,this.enclosed=t,this.coupla=a,this.sealed=r,this.loop_front=s,this.loop_left=n,this.loop_right=o,this.loop_back=i,this.loaders=l,this.weapon_mount=c}IsEnclosed(){let e=!1;e=e||this.enclosed;for(let t=0;t<this.loaders.length;t++)e=e||this.loaders[t].enclosed;return e}GetVisibility(e){let t;if(t=null==e?this:this.loaders[e],t.enclosed)return t.coupla?this.base_vis+1:this.base_vis}GetEscape(e){let t;if(t=null==e?this:this.loaders[e],t.enclosed)return t.coupla?this.base_escape+1:this.base_escape}CalcStats(e){let t=new k;this.name_txt==M[7].name?t.volume+=.25:this.name_txt==M[8].name?t.volume+=1:t.volume+=.5,this.enclosed&&this.coupla&&(t.cost+=1);for(let e=0;e<this.loaders.length;e++)t.volume+=.5,this.loaders[e].enclosed&&this.loaders[e].coupla&&(t.cost+=1);return t.add(this.weapon_mount.CalcStats(this.enclosed,e)),t}}class W{constructor(e,t,a,r){this.main_idx=e,this.directions=t,this.secondary_idx=a,this.shield=r,this.secondary_idx=this.secondary_idx.filter((e=>e>0)),0==this.main_idx&&this.secondary_idx.length>0&&(this.main_idx=this.secondary_idx[0],this.secondary_idx.splice(0,1))}GetNumLoaders(){let e=0;H[this.main_idx].loader&&e++;for(let t of this.secondary_idx)H[t].loader&&e++;return e}CalcStats(e,t){let a=new k;if(this.main_idx>0){a.add(this.WeapStats(this.main_idx));for(let e of this.secondary_idx)a.add(this.WeapStats(e));e&&this.IsArty()?(a.cost+=this.ArmourCost(t)*(this.DirCount()-1),this.directions[4]&&(a.cost+=3)):a.cost+=this.DirCount()-1,this.shield&&(a.cost+=3)}return a}WeapStats(e){let t=new k,a=H[e];return t.cost+=a.cost,t.volume=Math.ceil(a.heavy/2),a.artillery&&"ISC"!=a.abbr&&(t.cost+=2,t.integrity-=3),t}IsArty(){if(H[this.main_idx].artillery&&"ISC"!=H[this.main_idx].abbr)return!0;for(let e of this.secondary_idx)if(H[e].artillery&&"ISC"!=H[e].abbr)return!0;return!1}DirCount(){let e=0;for(let t=0;t<this.directions.length;t++)this.directions[t]&&e++;return e}ArmourCost(e){let t=0;return t=Math.max(t,e[0]),t=Math.max(t,e[1]),t=Math.max(t,e[2]),t}}class D{constructor(){this.powerplant_idx=3,this.powerplant_size_idx=1,this.propulsion_idx=3,this.armour_front=0,this.armour_side=0,this.armour_rear=0,this.extra_fuel=0,this.extra_tiny=!1,this.enlarged_engine=!1,this.propeller=!1,this.crew=[new F("Driver",!0,!0,!1,!1,!1,!1,!1,[],new W(0,[!0,!1,!1,!1,!1],[],!1)),new F("Commander",!0,!0,!1,!1,!1,!1,!1,[],new W(0,[!0,!1,!1,!1,!1],[],!1))],this.cargo=[0,0,0,0]}ValidateArmour(){for("Wind Powered"==L[this.powerplant_idx].name&&0!=this.SumArmour()&&(this.armour_front=0,this.armour_side=0,this.armour_rear=0),this.armour_front=Math.min(5,this.armour_front),this.armour_side=Math.min(5,this.armour_side),this.armour_rear=Math.min(5,this.armour_rear);this.SumArmour()>10;)0!=this.armour_rear?this.armour_rear--:0!=this.armour_side?this.armour_side--:this.armour_front--}SumArmour(){return this.armour_front+this.armour_side+this.armour_rear}SetCargo(e,t,a,r){this.cargo=[e,t,a,r],this.CalculateStats()}GetCargo(){let e=0;return this.extra_tiny&&(e+=1),[e,...this.cargo]}SetPowerplant(e){L[this.powerplant_idx].powerplants.length!=L[e].powerplants.length&&(this.powerplant_size_idx=Math.min(1,L[e].powerplants.length-1)),this.powerplant_idx=e,this.ValidateArmour(),this.CalculateStats()}GetPowerplantIdx(){return this.powerplant_idx}GetPowerplant(){return structuredClone(L[this.powerplant_idx])}GetPowerplantList(){return L}GetPowerplantSizeIdx(){return this.powerplant_size_idx}SetPowerplantSize(e){this.powerplant_size_idx=e,this.CalculateStats()}GetPowerplantSize(){return L[this.powerplant_idx].powerplants[this.powerplant_size_idx]}GetPowerplantSizeList(){return L[this.powerplant_idx].powerplants}GetPropulsionList(){return N}SetPropulsion(e){this.propulsion_idx=e,this.CalculateStats()}GetPropulsionIdx(){return this.propulsion_idx}GetPropulsion(){return N[this.propulsion_idx]}SetPropeller(e){this.propeller=e,this.CalculateStats()}CanPropeller(){switch(N[this.propulsion_idx]){case"Half-Track":case"Continuous Track":case"Crawler":case"Half-Walker":case"Walker":return!1;case"Monowheel":case"Two-Wheeled":case"Three-Wheeled":case"Four-Wheeled":case"Six-Wheeled":if(this.GetVolume()>4)return!1;case"Skids":case"Skiis":case"Boat Hull":case"Amphibious":case"Cable Car":case"Sky-Line":case"Dorandisch Earthline":if("Wind Powered"==L[this.powerplant_idx].name)return!1}return!0}ValidateLocomotion(){let e=this.GetVolume(),t=!1;for(;0==t;){switch(N[this.propulsion_idx]){case"Monowheel":case"Two-Wheeled":t=e<=1;break;case"Three-Wheeled":case"Four-Wheeled":case"Six-Wheeled":case"Half-Track":case"Continuous Track":case"Crawler":case"Half-Walker":case"Walker":t=e<=8;break;case"Skids":case"Skiis":t=e<=6;break;case"Boat Hull":case"Amphibious":case"Cable Car":case"Sky-Line":case"Dorandisch Earthline":t=!0;break;default:console.error("Unknonw Locomotion in ValidateLocomotion")}0==t&&(this.propulsion_idx+=1)}}SetArmourFront(e){for(e=Math.floor(1e-6+e),e=Math.max(0,e),e=Math.min(5,e),this.armour_front=e;this.SumArmour()>=10;)this.armour_front--;this.ValidateArmour(),this.CalculateStats()}GetArmourFront(){return this.armour_front}SetArmourSide(e){for(e=Math.floor(1e-6+e),e=Math.max(0,e),e=Math.min(5,e),this.armour_side=e;this.SumArmour()>=10;)this.armour_side--;this.ValidateArmour(),this.CalculateStats()}GetArmourSide(){return this.armour_side}SetArmourRear(e){for(e=Math.floor(1e-6+e),e=Math.max(0,e),e=Math.min(5,e),this.armour_rear=e;this.SumArmour()>=10;)this.armour_rear--;this.ValidateArmour(),this.CalculateStats()}GetArmourRear(){return this.armour_rear}CanExtraFuel(){return(this.GetPowerplantSize().fuel??0)>0}SetExtraFuel(e){e=Math.floor(1e-6+e),e=Math.max(0,e),this.extra_fuel=e,this.CalculateStats()}GetExtraFuel(){return this.extra_fuel}GetVolume(){let e=new k;e.volume+=this.extra_fuel;let t=[this.armour_front,this.armour_rear,this.armour_side],a=!1;for(let r=0;r<this.crew.length;r++)a=a||this.crew[r].IsEnclosed(),e.add(this.crew[r].CalcStats(t));return a&&(e.volume+=1),"Amphibious"==N[this.propulsion_idx]&&(e.volume+=1),this.enlarged_engine&&(e.volume+=1),e.volume+=1*this.cargo[0],e.volume+=2*this.cargo[1],e.volume+=4*this.cargo[2],e.volume+=8*this.cargo[3],e.volume}CalculateStats(){this.ValidateLocomotion();let e=[this.armour_front,this.armour_rear,this.armour_side];this.CanExtraFuel()||(this.extra_fuel=0);let t=new k;t.cost=3,t.torque=-1,t.volume+=this.extra_fuel;let a=!1;for(let r=0;r<this.crew.length;r++)a=a||this.crew[r].IsEnclosed(),t.add(this.crew[r].CalcStats(e));a&&(t.volume+=1),this.extra_tiny=t.volume-Math.floor(t.volume)>=.45,t.volume=Math.ceil(t.volume),t.handling+=T[t.volume].handling,t.speed+=T[t.volume].speedmod,t.integrity+=T[t.volume].integrity,"Amphibious"==N[this.propulsion_idx]&&(t.volume+=1,t.cost+=1),t.volume+=1*this.cargo[0],t.volume+=2*this.cargo[1],t.volume+=4*this.cargo[2],t.volume+=8*this.cargo[3];let r=t.volume;for(this.enlarged_engine&&(t.volume+=1,t.reliability-=1,r+=2),r=Math.max(T.length-1);E[this.powerplant_size_idx].HP>T[r].maxHP;)this.powerplant_size_idx-=1;t.add(new k(L[this.powerplant_idx])),t.add(new k(L[this.powerplant_idx].powerplants[this.powerplant_size_idx])),t.fuel*=this.extra_fuel+1;let s=this.SumArmour();t.handling-=2*s,t.safety+=Math.floor((Math.max(...e)+Math.min(...e))/2),e.forEach((e=>{e>=3&&(t.safety+=1,t.speed-=1,t.torque-=1)})),s>0&&(t.speed-=1,t.torque-=1,t.integrity+=2+s,s>=5&&(t.speed-=1,t.torque-=1,s>=10&&(t.speed-=1,t.torque-=1))),t.reliability-=Math.floor(1e-6+s/3);let n=0;s>=1&&(n-=1,s>=4&&(n-=1,s>=7&&(n-=1,s>=10&&(n-=1))));for(let e of this.crew)e.base_vis=n,e.base_escape=n;switch(this.propeller&&this.CanPropeller()&&(t.torque-=2,t.speed+=1,t.reliability+=1,t.stress+=1),N[this.propulsion_idx]){case"Monowheel":case"Two-Wheeled":t.speed+=1,t.torque-=s,t.cost-=1;break;case"Three-Wheeled":case"Four-Wheeled":t.volume>=6&&(t.torque-=1),t.torque-=Math.floor(s/3);break;case"Six-Wheeled":t.torque+=1,t.speed-=1,t.torque-=Math.floor(s/5);break;case"Half-Track":t.torque+=2,t.speed-=1,t.cost+=1;break;case"Continuous Track":t.torque+=4,t.speed-=2,t.handling-=5,"Large"==T[t.volume].size?t.torque+=1:"Huge"==T[t.volume].size&&(t.torque+=2),t.cost+=2;break;case"Crawler":case"Half-Walker":t.speed-=2,t.handling-=5,t.torque=3,t.speed=Math.min(t.speed,4),t.cost+=2;break;case"Walker":t.speed-=3,t.reliability-=1,t.handling+=5,t.upkeep+=1,t.torque=5,t.speed=Math.min(t.speed,3),t.cost+=4;break;case"Skids":case"Skiis":t.speed-=2,t.torque-=2;break;case"Boat Hull":t.speed=Math.min(t.speed,4),t.cost+=1;break;case"Amphibious":break;case"Cable Car":case"Sky-Line":t.reliability+=4,t.speed+=1;break;case"Dorandisch Earthline":t.reliability+=6,t.speed+=3}$&&$.UpdateDisplay(t)}SetCrew(e,t){e==this.crew.length?this.crew.push(t):e>=0&&e<this.crew.length?(t.loaders=this.crew[e].loaders,t.weapon_mount=this.crew[e].weapon_mount,this.crew[e]=t):console.error("SetCrew index out of range."),this.CalculateStats()}DeleteCrew(e){this.crew.splice(e,1),this.CalculateStats()}DuplicateCrew(e){this.crew.splice(e,0,this.crew[e]),this.CalculateStats()}SetLoader(e,t,a){e>=this.crew.length&&console.error("SetLoader crew index out of range.");let r=this.crew[e];t>=r.loaders.length?console.error("SetLoader loader index out of range."):r.loaders[t]=a,this.CalculateStats()}SetNumLoaders(e,t){if(e>=this.crew.length&&console.error("SetNumLoaders crew index out of range."),t<=0)this.crew[e].loaders=[];else{for(t=Math.min(t,this.crew[e].weapon_mount.GetNumLoaders());this.crew[e].loaders.length>t;)this.crew[e].loaders.pop();for(;this.crew[e].loaders.length<t;)this.crew[e].loaders.push(new G(!1,!1,!1,!1,!1,!1,!1))}this.CalculateStats()}GetCrewList(){return this.crew}SetWeapon(e,t){e>=this.crew.length&&console.error("SetWeapon crew index out of range."),this.crew[e].weapon_mount=t,this.CalculateStats()}}class R{constructor(e){this.stats=new U(e),this.armour=new z(e),this.crew=new O(e),this.weps=new j(e)}UpdateDisplay(e){this.stats.UpdateDisplay(e),this.armour.UpdateDisplay(),this.crew.UpdateDisplay(),this.weps.UpdateDisplay()}}class U{constructor(e){this.vehicle=e,this.name_lbl=document.getElementById("lbl_name"),this.nick_lbl=document.getElementById("lbl_nickname"),this.CreateStatTable(),this.CreateCrewTable()}CreateStatTable(){var e=document.getElementById("tbl_derived"),t=e.insertRow();this.AddHeader(t,"Speed").classList.add("thirdwidth"),this.AddHeader(t,"Torque").classList.add("thirdwidth"),this.AddHeader(t,"Handling").classList.add("thirdwidth");var a=e.insertRow();this.spd=this.AddData(a),this.trq=this.AddData(a),this.hnd=this.AddData(a);var r=e.insertRow();this.AddHeader(r,"Armour"),this.AddHeader(r,"Integrity"),this.AddHeader(r,"Safety");var s=e.insertRow();this.amr=this.AddData(s),this.int=this.AddData(s),this.sft=this.AddData(s);var n=e.insertRow();this.AddHeader(n,"Reliability"),this.AddHeader(n,"Fuel Uses"),this.AddHeader(n,"Stress");var o=e.insertRow();this.rel=this.AddData(o),this.ful=this.AddData(o),this.str=this.AddData(o);var i=e.insertRow();this.sze=i.insertCell(),this.sze.colSpan=3,this.crg=i.insertCell(),this.crg.colSpan=3}CreateCrewTable(){this.crw=document.getElementById("tbl_crew");var e=this.crw.insertRow(),t=this.AddData(e);t.colSpan=4,t.classList.add("tl"),this.AddHeader(e,"Type").colSpan=1,this.AddHeader(e,"Vis.").colSpan=1,this.AddHeader(e,"Escape").colSpan=1,this.AddHeader(e,"Notes").colSpan=1}AddHeader(e,t){var a=document.createElement("TH");return e.appendChild(a),a.colSpan=2,a.textContent=t,a}AddData(e){var t=e.insertCell();return t.colSpan=2,t}CrewLine(e,t,a,r,s,n=!1){var o=this.crw.insertRow();n&&o.insertCell().classList.add("borderless");var i=o.insertCell();i.textContent=e,i.colSpan=n?3:4,o.insertCell().textContent=t,o.insertCell().textContent=(a??"-").toString(),o.insertCell().textContent=(r??"-").toString(),o.insertCell().textContent=s}UpdateDisplay(e){this.name_lbl.innerHTML=r.Format('<p><span style="float:left;">{0}</span> <span style="float:right">{1}þ</span></p>',"Wandelburg Ausf. I",e.cost),this.nick_lbl.innerHTML=r.Format('<p><span style="float:left;">{0}</span> <span style="float:right">Upkeep {1}þ</span></p>',"The First Tank",e.upkeep),this.spd.textContent=e.speed.toString(),this.trq.textContent=e.torque.toString(),this.hnd.textContent=e.handling.toString(),this.amr.textContent=r.Format("{0}\\{1}\\{2}",this.vehicle.GetArmourFront(),this.vehicle.GetArmourSide(),this.vehicle.GetArmourRear()),this.int.textContent=e.integrity.toString(),this.sft.textContent=e.safety.toString(),this.rel.textContent=e.reliability.toString(),this.ful.textContent=e.fuel.toString(),this.str.textContent=e.stress.toString(),this.sze.textContent=T[Math.min(e.volume,T.length-1)].size.toString();let t=this.vehicle.GetCargo(),a=[];for(t[0]>0&&a.push(r.Format("{0} Tiny Cargo",t[0])),t[1]>0&&a.push(r.Format("{0} Small Cargo",t[1])),t[2]>0&&a.push(r.Format("{0} Medium Cargo",t[2])),t[3]>0&&a.push(r.Format("{0} Large Cargo",t[3])),t[4]>0&&a.push(r.Format("{0} Huge Cargo",t[4])),0==a.length&&a.push("No Cargo Space"),this.crg.textContent=r.Join(", ",a);this.crw.rows.length>1;)this.crw.deleteRow(1);var s=this.vehicle.GetCrewList();for(let e of s){let t="Exposed";e.enclosed&&(t="Closed",e.sealed&&(t="Sealed"));let a=[];e.enclosed&&e.coupla&&a.push("Hatch"),this.CrewLine(e.name_txt,t,e.GetVisibility(),e.GetEscape(),r.Join(", ",a));for(let t=0;t<e.loaders.length;t++){let a="Exposed";e.loaders[t].enclosed&&(a="Closed",e.loaders[t].sealed&&(a="Sealed"));let s=[];e.loaders[t].enclosed&&e.loaders[t].coupla&&s.push("Hatch"),this.CrewLine("Loader",a,e.GetVisibility(t),e.GetEscape(t),r.Join(", ",s),!0)}}}}class z{constructor(e){this.update_type=!0,this.vehicle=e,this.locomotion=document.getElementById("sel_loco");for(let e of this.vehicle.GetPropulsionList()){let t=document.createElement("OPTION");t.value=e,t.text=e,this.locomotion.append(t)}this.locomotion.onchange=()=>{this.vehicle.SetPropulsion(this.locomotion.selectedIndex)},this.prop_span=document.getElementById("prop_span"),this.propeller=document.getElementById("inp_prop"),this.propeller.onchange=()=>{this.vehicle.SetPropeller(this.propeller.checked)},this.pp_type=document.getElementById("sel_pptype"),this.pp_type.onchange=()=>{this.update_type=!0,this.vehicle.SetPowerplant(this.pp_type.selectedIndex)};for(let e of this.vehicle.GetPowerplantList()){let t=document.createElement("OPTION");t.value=e.name,t.text=e.name,this.pp_type.append(t)}this.pp_size=document.getElementById("sel_ppsize"),this.pp_size.onchange=()=>{this.vehicle.SetPowerplantSize(this.pp_size.selectedIndex)},this.SetSizeSel(),this.extra_fuel=document.getElementById("inp_fuel"),this.extra_fuel.min="0",this.extra_fuel.step="1",this.extra_fuel.onchange=()=>{this.vehicle.SetExtraFuel(this.extra_fuel.valueAsNumber)},this.front_armour=document.getElementById("inp_farm"),this.front_armour.min="0",this.front_armour.step="1",this.front_armour.onchange=()=>{this.vehicle.SetArmourFront(this.front_armour.valueAsNumber)},this.side_armour=document.getElementById("inp_sarm"),this.side_armour.min="0",this.side_armour.step="1",this.side_armour.onchange=()=>{this.vehicle.SetArmourSide(this.side_armour.valueAsNumber)},this.rear_armour=document.getElementById("inp_rarm"),this.rear_armour.min="0",this.rear_armour.step="1",this.rear_armour.onchange=()=>{this.vehicle.SetArmourRear(this.rear_armour.valueAsNumber)},this.s_cargo=document.getElementById("inp_scargo"),this.m_cargo=document.getElementById("inp_mcargo"),this.l_cargo=document.getElementById("inp_lcargo"),this.h_cargo=document.getElementById("inp_hcargo"),this.s_cargo.min="0",this.m_cargo.min="0",this.l_cargo.min="0",this.h_cargo.min="0",this.s_cargo.step="1",this.m_cargo.step="1",this.l_cargo.step="1",this.h_cargo.step="1",this.s_cargo.onchange=()=>{this.vehicle.SetCargo(this.s_cargo.valueAsNumber,this.m_cargo.valueAsNumber,this.l_cargo.valueAsNumber,this.h_cargo.valueAsNumber)},this.m_cargo.onchange=()=>{this.vehicle.SetCargo(this.s_cargo.valueAsNumber,this.m_cargo.valueAsNumber,this.l_cargo.valueAsNumber,this.h_cargo.valueAsNumber)},this.l_cargo.onchange=()=>{this.vehicle.SetCargo(this.s_cargo.valueAsNumber,this.m_cargo.valueAsNumber,this.l_cargo.valueAsNumber,this.h_cargo.valueAsNumber)},this.h_cargo.onchange=()=>{this.vehicle.SetCargo(this.s_cargo.valueAsNumber,this.m_cargo.valueAsNumber,this.l_cargo.valueAsNumber,this.h_cargo.valueAsNumber)}}SetSizeSel(){for(this.update_type=!1;this.pp_size.options.length;)this.pp_size.options.remove(0);for(let e of this.vehicle.GetPowerplantSizeList()){let t=document.createElement("OPTION");t.value=e.name,t.text=e.name,this.pp_size.append(t)}}UpdateLocomotion(){let e=this.vehicle.GetVolume();for(let t of this.locomotion.options){switch(t.text){case"Monowheel":case"Two-Wheeled":if(e>1){t.disabled=!0;continue}break;case"Three-Wheeled":case"Four-Wheeled":case"Six-Wheeled":case"Half-Track":case"Continuous Track":case"Crawler":case"Half-Walker":case"Walker":if(e>8){t.disabled=!0;continue}break;case"Skids":case"Skiis":if(e>6){t.disabled=!0;continue}break;case"Boat Hull":case"Amphibious":case"Cable Car":case"Sky-Line":case"Dorandisch Earthline":break;default:console.error("Unknonw Locomotion in MachineryDisp")}t.disabled=!1}}UpdateDisplay(){this.locomotion.selectedIndex=this.vehicle.GetPropulsionIdx(),this.vehicle.CanPropeller()?this.prop_span.hidden=!1:this.prop_span.hidden=!0,this.pp_type.selectedIndex=this.vehicle.GetPowerplantIdx(),this.update_type&&this.SetSizeSel(),this.pp_size.selectedIndex=this.vehicle.GetPowerplantSizeIdx(),this.extra_fuel.disabled=!this.vehicle.CanExtraFuel(),this.extra_fuel.valueAsNumber=this.vehicle.GetExtraFuel(),this.front_armour.valueAsNumber=this.vehicle.GetArmourFront(),this.side_armour.valueAsNumber=this.vehicle.GetArmourSide(),this.rear_armour.valueAsNumber=this.vehicle.GetArmourRear();let e=this.vehicle.GetCargo();this.s_cargo.valueAsNumber=e[1],this.m_cargo.valueAsNumber=e[2],this.l_cargo.valueAsNumber=e[3],this.h_cargo.valueAsNumber=e[4],this.UpdateLocomotion()}}var B=0;function q(e,t){var a=document.createElement("SPAN"),r=document.createElement("LABEL");return r.textContent=e,t.id="internal_id_"+(++B).toString(),r.htmlFor=t.id,a.append(r),a.append(t),a}class O{constructor(e){this.crewline=[],this.vehicle=e,this.crewdiv=document.getElementById("div_crew"),this.datalist=document.createElement("DATALIST");for(let e of M){let t=document.createElement("OPTION");t.value=e.name,t.text=e.name,this.datalist.append(t)}this.datalist.id="Crew_DataList",this.crewdiv.append(this.datalist),this.crewdiv.append(document.createElement("BR")),this.lastline=document.createElement("SELECT");for(let e of M){let t=document.createElement("OPTION");t.value=e.name,t.text=e.name,this.lastline.append(t)}this.lastline.onchange=()=>{this.vehicle.SetCrew(this.vehicle.GetCrewList().length,new F(this.lastline.options[this.lastline.selectedIndex].text,!1,!1,!1,!1,!1,!1,!1,[],new W(0,[!1,!1,!1,!1,!1],[],!1)))}}UpdateDisplay(){this.lastline.remove();for(var e=this.vehicle.GetCrewList();e.length>this.crewline.length;){let e=this.crewline.length;this.crewline.push(this.CreateLine(e))}for(;this.crewline.length>e.length;){let e=this.crewline.pop();e.span.remove(),e.br.remove()}for(let t=0;t<e.length;t++){let a=this.crewline[t],r=e[t];for(;r.loaders.length>a.loader.length;){let e=a.loader.length,r=this.CreateLoader(t,e);0==a.loader.length?(a.br.insertAdjacentElement("afterend",r.span),r.span.insertAdjacentElement("afterend",r.br)):(a.loader[a.loader.length-1].br.insertAdjacentElement("afterend",r.span),r.span.insertAdjacentElement("afterend",r.br)),a.loader.push(r)}for(;a.loader.length>r.loaders.length;){let e=a.loader.pop();e.span.remove(),e.br.remove()}if(a.name_span.hidden=!1,a.name.value=r.name_txt,a.enclosed.checked=r.enclosed,r.enclosed?(a.coup_span.hidden=!1,a.seal_span.hidden=!1,a.coupla.checked=r.coupla,a.seal.checked=r.sealed):(a.coup_span.hidden=!0,a.seal_span.hidden=!0),a.loop_front.checked=r.loop_front,a.loop_left.checked=r.loop_left,a.loop_right.checked=r.loop_right,a.loop_back.checked=r.loop_back,0==r.weapon_mount.GetNumLoaders()?a.has_loader.disabled=!0:a.has_loader.disabled=!1,0!=r.weapon_mount.main_idx){a.has_loader.valueAsNumber=r.loaders.length;for(let e=0;e<r.loaders.length;e++)a.loader[e].span.hidden=!1,a.loader[e].br.hidden=!1,a.loader[e].enclosed.checked=r.loaders[e].enclosed,r.loaders[e].enclosed?(a.loader[e].coup_span.hidden=!1,a.loader[e].seal_span.hidden=!1,a.loader[e].coupla.checked=r.loaders[e].coupla,a.loader[e].seal.checked=r.loaders[e].sealed,a.loader[e].loop_front.checked=r.loaders[e].loop_front,a.loader[e].loop_left.checked=r.loaders[e].loop_left,a.loader[e].loop_right.checked=r.loaders[e].loop_right,a.loader[e].loop_back.checked=r.loaders[e].loop_back):(a.loader[e].coup_span.hidden=!0,a.loader[e].seal_span.hidden=!0)}}this.crewdiv.append(this.lastline),this.lastline.selectedIndex=0}CreateLoader(e,t){let a={span:document.createElement("SPAN"),enc_span:void 0,enclosed:document.createElement("INPUT"),coup_span:void 0,coupla:document.createElement("INPUT"),seal_span:void 0,seal:document.createElement("INPUT"),loop_front:document.createElement("INPUT"),loop_left:document.createElement("INPUT"),loop_right:document.createElement("INPUT"),loop_back:document.createElement("INPUT"),br:document.createElement("BR")};a.enc_span=q("  Enclosed:",a.enclosed),a.coup_span=q("  Coupla/Hatch:",a.coupla),a.seal_span=q(" Sealed:",a.seal);let r=document.createElement("LABEL");r.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;Loader&nbsp;";let s=q("  Loopholes F/L/R/B:",a.loop_front);s.append(a.loop_left),s.append(a.loop_right),s.append(a.loop_back),a.span.append(r),a.span.append(a.enc_span),a.span.append(a.coup_span),a.span.append(a.seal_span),a.span.append(s),a.enclosed.type="checkbox",a.coupla.type="checkbox",a.seal.type="checkbox",a.loop_front.type="checkbox",a.loop_left.type="checkbox",a.loop_right.type="checkbox",a.loop_back.type="checkbox";let n=()=>{this.vehicle.SetLoader(e,t,new G(a.enclosed.checked,a.coupla.checked,a.seal.checked,a.loop_front.checked,a.loop_left.checked,a.loop_right.checked,a.loop_back.checked))};return a.enclosed.onchange=n,a.coupla.onchange=n,a.seal.onchange=n,a.loop_front.onchange=n,a.loop_left.onchange=n,a.loop_right.onchange=n,a.loop_back.onchange=n,a}CreateLine(e){let t={span:document.createElement("SPAN"),name_span:void 0,rem:document.createElement("BUTTON"),add:document.createElement("BUTTON"),name:document.createElement("INPUT"),enc_span:void 0,enclosed:document.createElement("INPUT"),coup_span:void 0,coupla:document.createElement("INPUT"),seal_span:void 0,seal:document.createElement("INPUT"),loop_front:document.createElement("INPUT"),loop_left:document.createElement("INPUT"),loop_right:document.createElement("INPUT"),loop_back:document.createElement("INPUT"),load_span:void 0,has_loader:document.createElement("INPUT"),br:document.createElement("BR"),loader:[]};t.name_span=q("  Name:",t.name),t.name.setAttribute("list",this.datalist.id),t.rem.textContent="-",t.rem.onclick=()=>{this.vehicle.DeleteCrew(e)},t.add.textContent="+",t.add.onclick=()=>{this.vehicle.DuplicateCrew(e)},0==e&&(t.rem.disabled=!0,t.add.disabled=!0),t.name_span.insertAdjacentElement("afterbegin",t.add),t.name_span.insertAdjacentElement("afterbegin",t.rem),t.enc_span=q("  Enclosed:",t.enclosed),t.coup_span=q("  Coupla/Hatch:",t.coupla),t.seal_span=q("  Sealed:",t.seal),t.load_span=q("  Loader:",t.has_loader);let a=q("  Loopholes F/L/R/B:",t.loop_front);a.append(t.loop_left),a.append(t.loop_right),a.append(t.loop_back),t.span.append(t.name_span),t.span.append(t.enc_span),t.span.append(t.coup_span),t.span.append(t.seal_span),t.span.append(a),t.span.append(t.load_span),t.name.type="text",t.enclosed.type="checkbox",t.coupla.type="checkbox",t.seal.type="checkbox",t.loop_front.type="checkbox",t.loop_left.type="checkbox",t.loop_right.type="checkbox",t.loop_back.type="checkbox",t.has_loader.type="number",t.has_loader.step="1",t.has_loader.min="0";let r=()=>{this.vehicle.SetCrew(e,new F(t.name.value,t.enclosed.checked,t.coupla.checked,t.seal.checked,t.loop_front.checked,t.loop_left.checked,t.loop_right.checked,t.loop_back.checked,void 0,void 0))};return t.name.onchange=r,t.enclosed.onchange=r,t.coupla.onchange=r,t.seal.onchange=r,t.loop_front.onchange=r,t.loop_left.onchange=r,t.loop_right.onchange=r,t.loop_back.onchange=r,t.has_loader.onchange=()=>{this.vehicle.SetNumLoaders(e,t.has_loader.valueAsNumber)},this.crewdiv.append(t.span),this.crewdiv.append(t.br),t}}class j{constructor(e){this.vehicle=e,this.tbl=document.getElementById("table_weapons");var a=this.tbl.insertRow();t(a,"Crew Position"),t(a,"Main Weapon"),t(a,"Firing Arcs"),t(a,"Secondary Weapons"),t(a,"Accessories"),this.wrows=[]}UpdateDisplay(){let e=this.vehicle.GetCrewList();for(;this.wrows.length>e.length;)this.wrows.pop(),this.tbl.deleteRow(this.tbl.rows.length-1);for(let t=0;t<e.length;t++){let a=e[t],r=a.weapon_mount;t>=this.wrows.length&&this.CreateRow(this.wrows.length);let s=this.wrows[t];for(s.crew.textContent=a.name_txt,s.main.selectedIndex=r.main_idx,s.f.checked=r.directions[0],s.r.checked=r.directions[1],s.b.checked=r.directions[2],s.l.checked=r.directions[3],s.u.checked=r.directions[4];s.secondary.length>r.secondary_idx.length+1;)s.sec_cell.removeChild(this.wrows[t].secondary.pop()),s.sec_cell.removeChild(s.sec_cell.children[s.sec_cell.children.length-1]);for(let e=0;e<r.secondary_idx.length;e++){if(e==s.secondary.length){let e=this.CreateSecondary();e.onchange=s.f.onchange,s.sec_cell.append(e),s.sec_cell.append(document.createElement("BR")),s.secondary.push(e)}s.secondary[e].selectedIndex=r.secondary_idx[e]}if(s.secondary.length==r.secondary_idx.length){let e=this.CreateSecondary();e.onchange=s.f.onchange,s.sec_cell.append(e),s.sec_cell.append(document.createElement("BR")),s.secondary.push(e)}s.secondary[r.secondary_idx.length].selectedIndex=0,s.shield.checked=r.shield,0==r.main_idx?(s.secondary[0].disabled=!0,s.f.disabled=!0,s.l.disabled=!0,s.r.disabled=!0,s.b.disabled=!0,s.u.disabled=!0,s.shield.disabled=!0):(s.secondary[0].disabled=!1,s.f.disabled=!1,s.l.disabled=!1,s.r.disabled=!1,s.b.disabled=!1,s.u.disabled=!1,r.IsArty()?s.shield.disabled=!0:s.shield.disabled=!1)}}CreateSecondary(){let e=document.createElement("SELECT");for(let t of H){let a=document.createElement("OPTION");a.value=t.name,a.text=t.name,e.append(a)}return e.selectedIndex=0,e}CreateRow(e){let t={row:this.tbl.insertRow(),crew:document.createElement("LABEL"),main:document.createElement("SELECT"),f:document.createElement("INPUT"),r:document.createElement("INPUT"),b:document.createElement("INPUT"),l:document.createElement("INPUT"),u:document.createElement("INPUT"),sec_cell:void 0,secondary:[],pspan:document.createElement("SPAN"),shield:document.createElement("INPUT")},r=()=>{this.vehicle.SetWeapon(e,new W(t.main.selectedIndex,[t.f.checked,t.r.checked,t.b.checked,t.l.checked,t.u.checked],t.secondary.map((e=>e.selectedIndex)),t.shield.checked))};t.row.insertCell().append(t.crew),t.row.insertCell().append(t.main);for(let e of H){let a=document.createElement("OPTION");a.value=e.name,a.text=e.name,t.main.append(a)}let s=t.row.insertCell();a("Forward",t.f,s,!0),a("Left",t.l,s,!1),a("Right",t.r,s,!0),a("Backward",t.b,s,!0),a("Upward",t.u,s,!1),t.main.onchange=r,t.f.onchange=r,t.r.onchange=r,t.b.onchange=r,t.l.onchange=r,t.u.onchange=r,t.sec_cell=t.row.insertCell(),t.row.insertCell().append(t.pspan),a("Gun Shield",t.shield,t.pspan,!1),t.shield.onchange=r,this.wrows.push(t)}}window.addEventListener("DOMContentLoaded",(()=>{const e=new URLSearchParams(location.search);e.get("json"),e.get("test"),V=new D,$=new R(V),V.CalculateStats(),window.addEventListener("load",(()=>{(function(e={}){n(),removeEventListener("click",l),f&&f(),f=void 0,b=void 0,g=e.getElement||p,_=e.scrollIntoView||u,b=new MutationObserver(c),addEventListener("click",l),f=void 0,s()})(),setTimeout((()=>{window.onscroll=function(e,t){let a;return function(){clearTimeout(a),a=setTimeout(e,250)}}(Y)}),1e3)}));var t=document.getElementsByClassName("collapsible");for(let e=0;e<t.length;e++)t[e].addEventListener("click",(function(){var e=this.classList.toggle("active"),t=this.nextElementSibling;(t=t.nextElementSibling).style.maxHeight=e?"inherit":"0px"}))}));var V,$,J="";function Y(e){const t=["Fight","Machinery","Crew","Weapons","Accessories","Stats"];var a="",r=window.pageYOffset;for(let e of t)if(0!=document.getElementById(e).offsetTop){if(!(r>document.getElementById(e).offsetTop))break;a=e}J!=a&&(J=a,window.history.replaceState(null,null,"index.html#"+a))}})();